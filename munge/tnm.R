

cancers[["t6"]] <- 
  forcats::fct_recode(
    cancers[["d_ajcc_t"]], 
    TX = "99",
    T0 = "00",
    Ta = "01",
    Tis = "05",
    Tispu = "06",
    Tispd = "07",
    T1 = "10",
    T1mic = "11",
    T1 = "19",
    T1a = "12",
    T1a1 = "13",
    T1a2 = "14",
    T1b = "15",
    T1b1 = "16",
    T1b2 = "17",
    T1c = "18",
    T2 = "20",
    T2 = "29",
    T2a = "21",
    T2b = "22",
    T2c = "23",
    T3 = "30",
    T3 = "39",
    T3a = "31",
    T3b = "32",
    T3c = "33",
    T4 = "40",
    T4 = "49",
    T4a = "41",
    T4b = "42",
    T4c = "43",
    T4d = "44",
    T1a = "80",
    T1b = "81",
    `NA` = "88" 
  )

cancers[["n6"]] <- 
  forcats::fct_recode(
    cancers[["d_ajcc_n"]], 
    `NX` = "99",
    `N0` = "00",
    `N0(i-)` = "01",
    `N0(i+)` = "02",
    `N0(mol-)` = "03",
    `N0(mol+)` = "04",
    `N1` = "10",
    `N1` = "19",
    `N1a` = "11",
    `N1b` = "12",
    `N1c` = "13",
    `N1mi` = "18",
    `N2` = "20",
    `N2` = "29",
    `N2a` = "21",
    `N2b` = "22",
    `N2c` = "23",
    `N3` = "30",
    `N3` = "39",
    `N3a` = "31",
    `N3b` = "32",
    `N3c` = "33",
    `NA` = "88"
  )

cancers[["m6"]] <- 
  forcats::fct_recode(
    cancers[["d_ajcc_m"]], 
    `MX` = "99",
    `M0` = "00",
    `M1` = "10",
    `M1a` = "11",
    `M1b` = "12",
    `M1c` = "13",
    `M1` = "19",
    `NA` = "88"
  )
  

cancers[["tnm6"]] <- 
  forcats::fct_recode(
    cancers[["d_ajcc_s"]], 
     `0` = "00",
    `0a` = "01",
    `0is` = "02",
    `I` = "10",
    `I` = "11",
    `IA` = "12",
    `IA1` = "13",
    `IA2` = "14",
    `IB` = "15",
    `IB1` = "16",
    `IB2` = "17",
    `IC` = "18",
    `IS` = "19",
    `ISA ` = "23",
    `ISB ` = "24",
    `IEA ` = "20",
    `IEB ` = "21",
    `IE ` = "22",
    `II` = "30",
    `II` = "31",
    `IIA` = "32",
    `IIB` = "33",
    `IIC` = "34",
    `IIEA ` = "35",
    `IIEB ` = "36",
    `IIE ` = "37",
    `IISA ` = "38",
    `IISB ` = "39",
    `IIS ` = "40",
    `IIESA ` = "41",
    `IIESB ` = "42",
    `IIES ` = "43",
    `III` = "50",
    `III` = "51",
    `IIIA` = "52",
    `IIIB` = "53",
    `IIIC` = "54",
    `IIIEA ` = "55",
    `IIIEB ` = "56",
    `IIIE ` = "57",
    `IIISA ` = "58",
    `IIISB ` = "59",
    `IIIS ` = "60",
    `IIIESA ` = "61",
    `IIIESB ` = "62",
    `IIIES ` = "63",
    `IV` = "70",
    `IV` = "71",
    `IVA` = "72",
    `IVB` = "73",
    `IVC` = "74",
    `NA` = "88",
    `Occult` = "90",
    `Unknown` = "99"
  )
cancers[["adj_t6"]] <- 
  forcats::fct_recode(
    cancers[["adjtm_6value"]], 
    TX = "99",
    T0 = "00",
    Ta = "01",
    Tis = "05",
    Tispu = "06",
    Tispd = "07",
    T1 = "10",
    T1mic = "11",
    T1 = "19",
    T1a = "12",
    T1a1 = "13",
    T1a2 = "14",
    T1b = "15",
    T1b1 = "16",
    T1b2 = "17",
    T1c = "18",
    T2 = "20",
    T2 = "29",
    T2a = "21",
    T2b = "22",
    T2c = "23",
    T3 = "30",
    T3 = "39",
    T3a = "31",
    T3b = "32",
    T3c = "33",
    T4 = "40",
    T4 = "49",
    T4a = "41",
    T4b = "42",
    T4c = "43",
    T4d = "44",
    T1a = "80",
    T1b = "81",
    `NA` = "88" 
  )

cancers[["adj_n6"]] <- 
  forcats::fct_recode(
    cancers[["adjnm_6value"]], 
    `NX` = "99",
    `N0` = "00",
    `N0(i-)` = "01",
    `N0(i+)` = "02",
    `N0(mol-)` = "03",
    `N0(mol+)` = "04",
    `N1` = "10",
    `N1` = "19",
    `N1a` = "11",
    `N1b` = "12",
    `N1c` = "13",
    `N1mi` = "18",
    `N2` = "20",
    `N2` = "29",
    `N2a` = "21",
    `N2b` = "22",
    `N2c` = "23",
    `N3` = "30",
    `N3` = "39",
    `N3a` = "31",
    `N3b` = "32",
    `N3c` = "33",
    `NA` = "88"
  )

cancers[["adj_m6"]] <- 
  forcats::fct_recode(
    cancers[["adjm_6value"]], 
    `MX` = "99",
    `M0` = "00",
    `M1` = "10",
    `M1a` = "11",
    `M1b` = "12",
    `M1c` = "13",
    `M1` = "19",
    `NA` = "88"
  )
  

cancers[["adj_tnm6"]] <- 
  forcats::fct_recode(
    cancers[["adjajccstg"]], 
     `0` = "00",
    `0a` = "01",
    `0is` = "02",
    `I` = "10",
    `I` = "11",
    `IA` = "12",
    `IA1` = "13",
    `IA2` = "14",
    `IB` = "15",
    `IB1` = "16",
    `IB2` = "17",
    `IC` = "18",
    `IS` = "19",
    `ISA ` = "23",
    `ISB ` = "24",
    `IEA ` = "20",
    `IEB ` = "21",
    `IE ` = "22",
    `II` = "30",
    `II` = "31",
    `IIA` = "32",
    `IIB` = "33",
    `IIC` = "34",
    `IIEA ` = "35",
    `IIEB ` = "36",
    `IIE ` = "37",
    `IISA ` = "38",
    `IISB ` = "39",
    `IIS ` = "40",
    `IIESA ` = "41",
    `IIESB ` = "42",
    `IIES ` = "43",
    `III` = "50",
    `III` = "51",
    `IIIA` = "52",
    `IIIB` = "53",
    `IIIC` = "54",
    `IIIEA ` = "55",
    `IIIEB ` = "56",
    `IIIE ` = "57",
    `IIISA ` = "58",
    `IIISB ` = "59",
    `IIIS ` = "60",
    `IIIESA ` = "61",
    `IIIESB ` = "62",
    `IIIES ` = "63",
    `IV` = "70",
    `IV` = "71",
    `IVA` = "72",
    `IVB` = "73",
    `IVC` = "74",
    `NA` = "88",
    `Occult` = "90",
    `Unknown` = "99"
  )

breasts <- cancers$which_cancer == "breast"

#not_missing <- function(v1, v2) {
#  ifelse(
#    is.na(cancers[[v1]][breasts]), 
#    cancers[[v2]][breasts], 
#    cancers[[v1]][breasts]
#  )
#}

#cancers[["t6"]][  breasts] <- not_missing("adj_t6", "t6")
#cancers[["n6"]][  breasts] <- not_missing("adj_n6", "m6")
#cancers[["m6"]][  breasts] <- not_missing("adj_m6", "m6")
#cancers[["tnm6"]][breasts] <- not_missing("adj_tnm6", "tnm6")

cancers[["t7"]] <- 
  forcats::fct_recode(
    cancers[["dajcc7t"]], 
    `TX` = "999",
    `T0` = "000",
    `Ta` = "010",
    `Tis` = "050",
    `Tispu (Urethra only)` = "060",
    `Tispd (Urethra only)` = "070",
    `T1` = "100",
    `T1mic` = "110",
    `T1` = "199",
    `T1a` = "120",
    `T1a1` = "130",
    `T1a2` = "140",
    `T1b` = "150",
    `T1b1` = "160",
    `T1b2` = "170",
    `T1c` = "180",
    `T1d` = "181",
    `T2` = "200",
    `T2` = "299",
    `T2a` = "210",
    `T2a1` = "211",
    `T2a2` = "212",
    `T2a` = "213",
    `T2b` = "220",
    `T2c` = "230",
    `T2d` = "240",
    `T3` = "300",
    `T3` = "399",
    `T3a` = "310",
    `T3b` = "320",
    `T3c` = "330",
    `T4` = "400",
    `T4` = "499",
    `T4a` = "410",
    `T4b` = "420",
    `T4c` = "430",
    `T4d` = "440",
    `T4e` = "450",
    `T1a` = "800",
    `T1b` = "810",
    `NA` = "888"
  )


cancers[["n7"]] <- 
  forcats::fct_recode(
    cancers[["dajcc7n"]], 
    `NX` = "999",
    `N0` = "000",
    `N0(i-)` = "010",
    `N0(i+)` = "020",
    `N0(mol-)` = "030",
    `N0(mol+)` = "040",
    `N1` = "100",
    `N1` = "199",
    `N1a` = "110",
    `N1b` = "120",
    `N1c` = "130",
    `N1mi` = "180",
    `N2` = "200",
    `N2` = "299",
    `N2a` = "210",
    `N2b` = "220",
    `N2c` = "230",
    `N3` = "300",
    `N3` = "399",
    `N3a` = "310",
    `N3b` = "320",
    `N3c` = "330",
    `N4` = "400",
    `NA` = "888"
  )


cancers[["m7"]] <- 
  forcats::fct_recode(
    cancers[["dajcc7m"]],
    `MX` = "999",
    `M0` = "000",
    `M0(i+)` = "010",
    `M1` = "100",
    `M1a` = "110",
    `M1b` = "120",
    `M1c` = "130",
    `M1d` = "140",
    `M1e` = "150",
    `M1` = "199",
    `NA` = "888"
  )

cancers[["tnm7"]] <- 
  forcats::fct_recode(
    cancers[["dajcc7stg"]], 
    `0` = "000",
    `0a` = "010",
    `0is` = "020",
    `I` = "100",
    `I` = "110",
    `IA` = "120",
    `IA1` = "130",
    `IA2` = "140",
    `IA` = "121",
    `IB` = "150",
    `IB1` = "160",
    `IB2` = "170",
    `IB` = "151",
    `IC` = "180",
    `IS` = "190",
    `ISA` = "230",
    `ISB` = "240",
    `IEA` = "200",
    `IEB` = "210",
    `IE` = "220",
    `II` = "300",
    `II` = "310",
    `IIA` = "320",
    `IIA` = "321",
    `IIA1` = "322",
    `IIA` = "323",
    `IIB` = "330",
    `IIC` = "340",
    `IIEA` = "350",
    `IIEB` = "360",
    `IIE` = "370",
    `IISA` = "380",
    `IISB` = "390",
    `IIS` = "400",
    `IIESA` = "410",
    `IIESB` = "420",
    `IIES` = "430",
    `III` = "500",
    `III` = "510",
    `IIIA` = "520",
    `IIIB` = "530",
    `IIIC` = "540",
    `IIIC1` = "541",
    `IIIC2` = "542",
    `IIIEA` = "550",
    `IIIEB` = "560",
    `IIIE` = "570",
    `IIISA` = "580",
    `IIISB` = "590",
    `IIIS` = "600",
    `IIIESA` = "610",
    `IIIESB` = "620",
    `IIIES` = "630",
    `IV` = "700",
    `IV` = "710",
    `IVA` = "720",
    `IVB` = "730",
    `IVC` = "740",
    `NA` = "888",
    `Occult` = "900",
    `Unknown` = "999"
  )








